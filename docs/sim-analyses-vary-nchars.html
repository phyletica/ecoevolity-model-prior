
<!DOCTYPE html>

<html>
  <head>
    <meta charset="utf-8" />
    <title>Varying dataset size &#8212; Ecoevolity model prior experiments 0.1.0 documentation</title>
    <link rel="stylesheet" href="_static/alabaster.css" type="text/css" />
    <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
    <script id="documentation_options" data-url_root="./" src="_static/documentation_options.js"></script>
    <script src="_static/jquery.js"></script>
    <script src="_static/underscore.js"></script>
    <script src="_static/doctools.js"></script>
    <script src="_static/language_data.js"></script>
    <link rel="author" title="About these documents" href="about.html" />
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="Working on project docs" href="working-on-docs.html" />
    <link rel="prev" title="Simulation-based analyses" href="sim-analyses.html" />
   
  <link rel="stylesheet" href="_static/custom.css" type="text/css" />
  
  
  <meta name="viewport" content="width=device-width, initial-scale=0.9, maximum-scale=0.9" />

  </head><body>
  <div class="document">
    
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
<h1 class="logo"><a href="index.html">Ecoevolity model prior experiments</a></h1>



<p class="blurb">Experimenting with new comparative phylogeographical models</p>




<p>
<iframe src="https://ghbtns.com/github-btn.html?user=phyletica&repo=ecoevolity-model-prior&type=watch&count=true&size=large&v=2"
  allowtransparency="true" frameborder="0" scrolling="0" width="200px" height="35px"></iframe>
</p>





<h3>Navigation</h3>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="about.html">About</a></li>
<li class="toctree-l1"><a class="reference internal" href="background.html">Background</a></li>
<li class="toctree-l1"><a class="reference internal" href="prerequisites.html">Before starting</a></li>
<li class="toctree-l1"><a class="reference internal" href="getting-started.html">Getting started</a></li>
<li class="toctree-l1"><a class="reference internal" href="project-tour.html">Project Tour</a></li>
<li class="toctree-l1"><a class="reference internal" href="ecoevolity-configs.html">The ecoevolity configs</a></li>
<li class="toctree-l1"><a class="reference internal" href="sample-priors.html">Sampling the model priors</a></li>
<li class="toctree-l1"><a class="reference internal" href="sim-analyses.html">Simulation-based analyses</a></li>
<li class="toctree-l1 current"><a class="current reference internal" href="#">Varying dataset size</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#setup-our-environment">Setup our environment</a></li>
<li class="toctree-l2"><a class="reference internal" href="#create-simulation-scripts">Create simulation scripts</a></li>
<li class="toctree-l2"><a class="reference internal" href="#run-simulation-scripts">Run simulation scripts</a></li>
<li class="toctree-l2"><a class="reference internal" href="#analyzing-simulated-data">Analyzing simulated data</a></li>
<li class="toctree-l2"><a class="reference internal" href="#summarizing-the-results">Summarizing the results</a></li>
<li class="toctree-l2"><a class="reference internal" href="#cleaning-up">Cleaning up</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="working-on-docs.html">Working on project docs</a></li>
<li class="toctree-l1"><a class="reference internal" href="acknowledgments.html">Acknowledgments</a></li>
<li class="toctree-l1"><a class="reference internal" href="citation.html">Citation</a></li>
<li class="toctree-l1"><a class="reference internal" href="license.html">License</a></li>
<li class="toctree-l1"><a class="reference internal" href="glossary.html">Glossary</a></li>
<li class="toctree-l1"><a class="reference internal" href="zbib/references.html">Literature Cited</a></li>
</ul>

<div class="relations">
<h3>Related Topics</h3>
<ul>
  <li><a href="index.html">Documentation overview</a><ul>
      <li>Previous: <a href="sim-analyses.html" title="previous chapter">Simulation-based analyses</a></li>
      <li>Next: <a href="working-on-docs.html" title="next chapter">Working on project docs</a></li>
  </ul></li>
</ul>
</div>
<div id="searchbox" style="display: none" role="search">
  <h3 id="searchlabel">Quick search</h3>
    <div class="searchformwrapper">
    <form class="search" action="search.html" method="get">
      <input type="text" name="q" aria-labelledby="searchlabel" />
      <input type="submit" value="Go" />
    </form>
    </div>
</div>
<script>$('#searchbox').show(0);</script>








        </div>
      </div>
      <div class="documentwrapper">
        <div class="bodywrapper">
          

          <div class="body" role="main">
            
  <div class="section" id="varying-dataset-size">
<span id="sim-analyses-vary-nchars"></span><h1>Varying dataset size<a class="headerlink" href="#varying-dataset-size" title="Permalink to this headline">¶</a></h1>
<p>In the <a class="reference internal" href="sim-analyses.html#sim-analyses"><span class="std std-ref">Simulation-based analyses</span></a> section, all of the datasets we simulated and
analyzed consisted of 500,000 characters.
Now, we are going to simulate and analyze datasets with
5,000
10,000
50,000
and
100,000
characters
to see how our models perform.</p>
<p>We saw from the results of the analyses in the <a class="reference internal" href="sim-analyses.html#sim-analyses"><span class="std std-ref">Simulation-based analyses</span></a>
section that the most challenging simulation conditions for the
models we are comparing was when all 10 pairs of populations
diverge independently (i.e., the constrained model
defined in the
<code class="docutils literal notranslate"><span class="pre">fixed-pairs-10-independent-time-1_0-0_05.yml</span></code>
config file).
As a result, for the analyses in this section, we will simulate all of the
datasets under this model.
We will then analyze these datasets under the three models we are comparing:</p>
<ol class="arabic simple">
<li><p>Dirichlet-process (DP) prior</p></li>
<li><p>Pitman-Yor process (PYP) prior</p></li>
<li><p>Uniform distribution with a split-weight parameter (SW)</p></li>
</ol>
<div class="section" id="setup-our-environment">
<h2>Setup our environment<a class="headerlink" href="#setup-our-environment" title="Permalink to this headline">¶</a></h2>
<p>Before anything else, navigate to the project directory (if you are not already
there):</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">cd</span> <span class="o">/</span><span class="n">path</span><span class="o">/</span><span class="n">to</span><span class="o">/</span><span class="n">your</span><span class="o">/</span><span class="n">copy</span><span class="o">/</span><span class="n">of</span><span class="o">/</span><span class="n">ecoevolity</span><span class="o">-</span><span class="n">model</span><span class="o">-</span><span class="n">prior</span>
</pre></div>
</div>
<p>If you haven’t already, let’s activate the Python environment for this project:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">conda</span> <span class="n">activate</span> <span class="n">ecoevolity</span><span class="o">-</span><span class="n">model</span><span class="o">-</span><span class="n">prior</span><span class="o">-</span><span class="n">project</span>
</pre></div>
</div>
</div>
<div class="section" id="create-simulation-scripts">
<h2>Create simulation scripts<a class="headerlink" href="#create-simulation-scripts" title="Permalink to this headline">¶</a></h2>
<p>Now, lets <code class="docutils literal notranslate"><span class="pre">cd</span></code> into the project’s <code class="docutils literal notranslate"><span class="pre">scripts</span></code> directory:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">cd</span> <span class="n">scripts</span>
</pre></div>
</div>
<p>Use the <code class="docutils literal notranslate"><span class="pre">create_new_batch_of_simcoevolity-scripts.py</span></code> script to create
simcoevolity scripts for generating a new batch of simulated datasets with
varying numbers of characters under the “independent divergences” model:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">python</span> <span class="n">create_new_batch_of_simcoevolity</span><span class="o">-</span><span class="n">scripts</span><span class="o">.</span><span class="n">py</span> <span class="o">-</span><span class="n">n</span> <span class="mi">10</span> <span class="n">simcoevolity</span><span class="o">-</span><span class="n">scripts</span><span class="o">/</span><span class="n">template</span><span class="o">-</span><span class="n">simcoevolity</span><span class="o">-*-</span><span class="n">chars</span><span class="o">-*</span><span class="mf">00.</span><span class="n">template</span>
</pre></div>
</div>
<p>The output should confirm the creation of 5 new scripts for running
<code class="docutils literal notranslate"><span class="pre">simcoevolity</span></code> (one for each config in <code class="docutils literal notranslate"><span class="pre">ecoevolity-configs</span></code>), and report a
batch ID:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">Script</span> <span class="n">written</span> <span class="n">to</span> <span class="s1">&#39;simcoevolity-scripts/simcoevolity-fixed-pairs-10-independent-time-1_0-0_05-chars-100000-batch-308303035.sh&#39;</span>
<span class="n">Script</span> <span class="n">written</span> <span class="n">to</span> <span class="s1">&#39;simcoevolity-scripts/simcoevolity-fixed-pairs-10-independent-time-1_0-0_05-chars-10000-batch-308303035.sh&#39;</span>
<span class="n">Script</span> <span class="n">written</span> <span class="n">to</span> <span class="s1">&#39;simcoevolity-scripts/simcoevolity-fixed-pairs-10-independent-time-1_0-0_05-chars-50000-batch-308303035.sh&#39;</span>
<span class="n">Script</span> <span class="n">written</span> <span class="n">to</span> <span class="s1">&#39;simcoevolity-scripts/simcoevolity-fixed-pairs-10-independent-time-1_0-0_05-chars-5000-batch-308303035.sh&#39;</span>

<span class="n">Simcoevolity</span> <span class="n">scripts</span> <span class="n">successfully</span> <span class="n">written</span><span class="o">.</span>

<span class="n">Batch</span> <span class="n">ID</span><span class="p">:</span>
    <span class="mi">308303035</span>
</pre></div>
</div>
<p>But, your batch ID number will be different.</p>
<p><strong>IMPORTANT: Make a note of your batch ID number, you will need it moving forward.</strong>
For all of the commands below, use your batch ID number in place of
<code class="docutils literal notranslate"><span class="pre">308303035</span></code>.</p>
<div class="section" id="commit-simulation-scripts">
<h3>Commit simulation scripts<a class="headerlink" href="#commit-simulation-scripts" title="Permalink to this headline">¶</a></h3>
<p>Before we run the <code class="docutils literal notranslate"><span class="pre">simcoevolity</span></code> scripts, let’s add them to the staging area
of project Git repository:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">git</span> <span class="n">add</span> <span class="n">simcoevolity</span><span class="o">-</span><span class="n">scripts</span><span class="o">/*</span><span class="mf">308303035.</span><span class="n">sh</span>
</pre></div>
</div>
<p>Then, commit them to the repository:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">git</span> <span class="n">commit</span>
</pre></div>
</div>
<p>A good commit message might look something like:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">Adding</span> <span class="n">batch</span> <span class="mi">308303035</span> <span class="n">of</span> <span class="n">simcoevolity</span> <span class="n">scripts</span><span class="o">.</span>

<span class="n">Adding</span> <span class="n">shell</span> <span class="n">scripts</span> <span class="n">generated</span> <span class="n">by</span><span class="p">:</span>

    <span class="n">create_new_batch_of_simcoevolity</span><span class="o">-</span><span class="n">scripts</span><span class="o">.</span><span class="n">py</span>

<span class="n">These</span> <span class="n">scripts</span> <span class="n">will</span> <span class="n">run</span> <span class="n">simcoevolity</span> <span class="n">to</span> <span class="n">generate</span> <span class="n">a</span> <span class="n">batch</span> <span class="n">of</span> <span class="mi">10</span>
<span class="n">simulated</span> <span class="n">datasets</span> <span class="n">each</span> <span class="k">for</span> <span class="mi">4</span> <span class="n">different</span> <span class="n">sizes</span> <span class="n">of</span> <span class="n">datasets</span><span class="o">.</span>
</pre></div>
</div>
<p>Lastly, push the new scripts to the remote repository hosted on a <a class="reference external" href="https://github.com/">GitHub</a>:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">git</span> <span class="n">push</span> <span class="n">origin</span> <span class="n">master</span>
</pre></div>
</div>
</div>
</div>
<div class="section" id="run-simulation-scripts">
<h2>Run simulation scripts<a class="headerlink" href="#run-simulation-scripts" title="Permalink to this headline">¶</a></h2>
<p>Next, <code class="docutils literal notranslate"><span class="pre">cd</span></code> into the <code class="docutils literal notranslate"><span class="pre">simcoevolity-scripts</span></code> directory:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">cd</span> <span class="n">simcoevolity</span><span class="o">-</span><span class="n">scripts</span>
</pre></div>
</div>
<p>If you are working on AU’s Hopper cluster, use a for loop to submit the five
<code class="docutils literal notranslate"><span class="pre">simcoevolity</span></code> scripts to the queue:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="k">for</span> <span class="n">script_path</span> <span class="ow">in</span> <span class="o">*</span><span class="mf">308303035.</span><span class="n">sh</span><span class="p">;</span> <span class="n">do</span> <span class="o">../../</span><span class="nb">bin</span><span class="o">/</span><span class="n">psub</span> <span class="s2">&quot;$script_path&quot;</span><span class="p">;</span> <span class="n">done</span>
</pre></div>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>If you are working on a different cluster, you will need
to either update the <code class="docutils literal notranslate"><span class="pre">../../bin/psub</span></code> to work for your system,
or replace <code class="docutils literal notranslate"><span class="pre">../../bin/psub</span></code> with whatever command is used on your
cluster to submit jobs.</p>
<p>If you are not on a cluster, you can simply run the scripts directly:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="k">for</span> <span class="n">script_path</span> <span class="ow">in</span> <span class="o">*</span><span class="mf">308303035.</span><span class="n">sh</span><span class="p">;</span> <span class="n">do</span> <span class="n">bash</span> <span class="s2">&quot;$script_path&quot;</span><span class="p">;</span> <span class="n">done</span>
</pre></div>
</div>
</div>
<p>After submitting the scripts with the for loop, go ahead and <code class="docutils literal notranslate"><span class="pre">cd</span></code> out of the
<code class="docutils literal notranslate"><span class="pre">simcoevolity-scripts</span></code> directory, which will put you back up in the
<code class="docutils literal notranslate"><span class="pre">scripts</span></code> directory:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">cd</span> <span class="o">..</span>
</pre></div>
</div>
<p>Assuming you are on the Hopper cluster, you can monitor the progress of
the jobs by using:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">qstat</span>
</pre></div>
</div>
<p>The simulation files generated by <code class="docutils literal notranslate"><span class="pre">simcoevolity</span></code>
will be output to subdirectories of the <code class="docutils literal notranslate"><span class="pre">ecoevolity-simulations</span></code> directory.
When the jobs finish, from the <code class="docutils literal notranslate"><span class="pre">scripts</span></code> directory you can type:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">ls</span> <span class="o">../</span><span class="n">ecoevolity</span><span class="o">-</span><span class="n">simulations</span><span class="o">/</span><span class="n">fixed</span><span class="o">-</span><span class="n">pairs</span><span class="o">-</span><span class="mi">10</span><span class="o">-</span><span class="n">independent</span><span class="o">-</span><span class="n">time</span><span class="o">-</span><span class="mi">1_0</span><span class="o">-</span><span class="mi">0_05</span><span class="o">-</span><span class="n">chars</span><span class="o">-*</span><span class="mi">00</span>
</pre></div>
</div>
<p>This should show 4 directories, one for each of the different sized datasets we
simulated:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">fixed</span><span class="o">-</span><span class="n">pairs</span><span class="o">-</span><span class="mi">10</span><span class="o">-</span><span class="n">independent</span><span class="o">-</span><span class="n">time</span><span class="o">-</span><span class="mi">1_0</span><span class="o">-</span><span class="mi">0_05</span><span class="o">-</span><span class="n">chars</span><span class="o">-</span><span class="mi">10000</span>
<span class="n">fixed</span><span class="o">-</span><span class="n">pairs</span><span class="o">-</span><span class="mi">10</span><span class="o">-</span><span class="n">independent</span><span class="o">-</span><span class="n">time</span><span class="o">-</span><span class="mi">1_0</span><span class="o">-</span><span class="mi">0_05</span><span class="o">-</span><span class="n">chars</span><span class="o">-</span><span class="mi">100000</span>
<span class="n">fixed</span><span class="o">-</span><span class="n">pairs</span><span class="o">-</span><span class="mi">10</span><span class="o">-</span><span class="n">independent</span><span class="o">-</span><span class="n">time</span><span class="o">-</span><span class="mi">1_0</span><span class="o">-</span><span class="mi">0_05</span><span class="o">-</span><span class="n">chars</span><span class="o">-</span><span class="mi">5000</span>
<span class="n">fixed</span><span class="o">-</span><span class="n">pairs</span><span class="o">-</span><span class="mi">10</span><span class="o">-</span><span class="n">independent</span><span class="o">-</span><span class="n">time</span><span class="o">-</span><span class="mi">1_0</span><span class="o">-</span><span class="mi">0_05</span><span class="o">-</span><span class="n">chars</span><span class="o">-</span><span class="mi">50000</span>
</pre></div>
</div>
<p>Within each fo these 4 directories should be a directory associated with <em>your</em>
batch number <code class="docutils literal notranslate"><span class="pre">batch-308303035</span></code>.</p>
</div>
<div class="section" id="analyzing-simulated-data">
<h2>Analyzing simulated data<a class="headerlink" href="#analyzing-simulated-data" title="Permalink to this headline">¶</a></h2>
<p>Next, we will use <code class="docutils literal notranslate"><span class="pre">ecoevolity</span></code> to analyze each simulation dataset four
times under 6 different configurations (the DP, PYP, and SW models using and
ignoring the constant characters).
Given that we simulated 10 datasets each of 4 different sizes, this
will be <img class="math" src="_images/math/4f07a3c8d1065b70c873c5ea537d23dc20f78ec3.svg" alt="24 \times 10 \times 4 = 960"/> <code class="docutils literal notranslate"><span class="pre">ecoevolity</span></code> analyses.</p>
<p>If you are on the Hopper cluster, we will use a script that will run all of
these analyses as a single job array.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>If you are <strong>not</strong> on the Hopper cluster, the <code class="docutils literal notranslate"><span class="pre">submit_sim_analyses.sh</span></code>
script we use below will not work on your system.
You will either need to update that script to work with your system,
or simply submit all theses analyses “manually.”
This can be done easily with a for loop. For example:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="k">for</span> <span class="n">script_path</span> <span class="ow">in</span> <span class="o">../</span><span class="n">ecoevolity</span><span class="o">-</span><span class="n">simulations</span><span class="o">/*/</span><span class="n">batch</span><span class="o">-</span><span class="mi">308303035</span><span class="o">/*</span><span class="n">qsub</span><span class="o">.</span><span class="n">sh</span><span class="p">;</span> <span class="n">do</span> <span class="n">echo</span> <span class="s2">&quot;$script_path&quot;</span><span class="p">;</span> <span class="n">done</span>
</pre></div>
</div>
<p>Just change “echo” to whatever command is necessary to submit jobs on your
system (and remember your batch ID number is different).</p>
</div>
<p>To do this, make sure you are in the <code class="docutils literal notranslate"><span class="pre">scripts</span></code> directory of the project and
enter:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">bash</span> <span class="n">submit_sim_analyses</span><span class="o">.</span><span class="n">sh</span> <span class="o">../</span><span class="n">ecoevolity</span><span class="o">-</span><span class="n">simulations</span><span class="o">/*/</span><span class="n">batch</span><span class="o">-</span><span class="mi">308303035</span>
</pre></div>
</div>
<p>This will produce a lot of output, because the script first looks for results
of each analysis, and, if the results are absent (or incomplete), it adds a job
to the job array to run the analysis and writes you a message as to why.
Because this is our first time running the job-submission script,
no results are present, and all analyses will be run (hence all the output).</p>
<p>On hopper you can monitor the job array using:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">qstat</span> <span class="o">-</span><span class="n">t</span>
</pre></div>
</div>
<p>which will show the full list of jobs in the array that are running or waiting
to run:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">Job</span> <span class="n">ID</span>                    <span class="n">Name</span>             <span class="n">User</span>            <span class="n">Time</span> <span class="n">Use</span> <span class="n">S</span> <span class="n">Queue</span>
<span class="o">-------------------------</span> <span class="o">----------------</span> <span class="o">---------------</span> <span class="o">--------</span> <span class="o">-</span> <span class="o">-----</span>
<span class="mi">1942324</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">hopper</span><span class="o">-</span><span class="n">mgt</span>      <span class="o">...</span><span class="n">n_job_array</span><span class="o">-</span><span class="mi">1</span> <span class="n">jro0014</span>         <span class="mi">00</span><span class="p">:</span><span class="mi">00</span><span class="p">:</span><span class="mi">53</span> <span class="n">R</span> <span class="n">general</span>
<span class="mi">1942324</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="o">.</span><span class="n">hopper</span><span class="o">-</span><span class="n">mgt</span>      <span class="o">...</span><span class="n">n_job_array</span><span class="o">-</span><span class="mi">2</span> <span class="n">jro0014</span>         <span class="mi">00</span><span class="p">:</span><span class="mi">00</span><span class="p">:</span><span class="mi">53</span> <span class="n">R</span> <span class="n">general</span>
<span class="mi">1942324</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span><span class="o">.</span><span class="n">hopper</span><span class="o">-</span><span class="n">mgt</span>      <span class="o">...</span><span class="n">n_job_array</span><span class="o">-</span><span class="mi">3</span> <span class="n">jro0014</span>         <span class="mi">00</span><span class="p">:</span><span class="mi">00</span><span class="p">:</span><span class="mi">52</span> <span class="n">R</span> <span class="n">general</span>
<span class="mi">1942324</span><span class="p">[</span><span class="mi">4</span><span class="p">]</span><span class="o">.</span><span class="n">hopper</span><span class="o">-</span><span class="n">mgt</span>      <span class="o">...</span><span class="n">n_job_array</span><span class="o">-</span><span class="mi">4</span> <span class="n">jro0014</span>         <span class="mi">00</span><span class="p">:</span><span class="mi">00</span><span class="p">:</span><span class="mi">52</span> <span class="n">R</span> <span class="n">general</span>
<span class="mi">1942324</span><span class="p">[</span><span class="mi">5</span><span class="p">]</span><span class="o">.</span><span class="n">hopper</span><span class="o">-</span><span class="n">mgt</span>      <span class="o">...</span><span class="n">n_job_array</span><span class="o">-</span><span class="mi">5</span> <span class="n">jro0014</span>         <span class="mi">00</span><span class="p">:</span><span class="mi">00</span><span class="p">:</span><span class="mi">29</span> <span class="n">R</span> <span class="n">general</span>
<span class="mi">1942324</span><span class="p">[</span><span class="mi">6</span><span class="p">]</span><span class="o">.</span><span class="n">hopper</span><span class="o">-</span><span class="n">mgt</span>      <span class="o">...</span><span class="n">n_job_array</span><span class="o">-</span><span class="mi">6</span> <span class="n">jro0014</span>         <span class="mi">00</span><span class="p">:</span><span class="mi">00</span><span class="p">:</span><span class="mi">29</span> <span class="n">R</span> <span class="n">general</span>
<span class="mi">1942324</span><span class="p">[</span><span class="mi">7</span><span class="p">]</span><span class="o">.</span><span class="n">hopper</span><span class="o">-</span><span class="n">mgt</span>      <span class="o">...</span><span class="n">n_job_array</span><span class="o">-</span><span class="mi">7</span> <span class="n">jro0014</span>         <span class="mi">00</span><span class="p">:</span><span class="mi">00</span><span class="p">:</span><span class="mi">28</span> <span class="n">R</span> <span class="n">general</span>
<span class="mi">1942324</span><span class="p">[</span><span class="mi">8</span><span class="p">]</span><span class="o">.</span><span class="n">hopper</span><span class="o">-</span><span class="n">mgt</span>      <span class="o">...</span><span class="n">n_job_array</span><span class="o">-</span><span class="mi">8</span> <span class="n">jro0014</span>         <span class="mi">00</span><span class="p">:</span><span class="mi">00</span><span class="p">:</span><span class="mi">28</span> <span class="n">R</span> <span class="n">general</span>
<span class="mi">1942324</span><span class="p">[</span><span class="mi">9</span><span class="p">]</span><span class="o">.</span><span class="n">hopper</span><span class="o">-</span><span class="n">mgt</span>      <span class="o">...</span><span class="n">n_job_array</span><span class="o">-</span><span class="mi">9</span> <span class="n">jro0014</span>         <span class="mi">00</span><span class="p">:</span><span class="mi">00</span><span class="p">:</span><span class="mi">27</span> <span class="n">R</span> <span class="n">general</span>
<span class="mi">1942324</span><span class="p">[</span><span class="mi">10</span><span class="p">]</span><span class="o">.</span><span class="n">hopper</span><span class="o">-</span><span class="n">mgt</span>     <span class="o">...</span><span class="n">_job_array</span><span class="o">-</span><span class="mi">10</span> <span class="n">jro0014</span>         <span class="mi">00</span><span class="p">:</span><span class="mi">00</span><span class="p">:</span><span class="mi">12</span> <span class="n">R</span> <span class="n">general</span>
<span class="mi">1942324</span><span class="p">[</span><span class="mi">11</span><span class="p">]</span><span class="o">.</span><span class="n">hopper</span><span class="o">-</span><span class="n">mgt</span>     <span class="o">...</span><span class="n">_job_array</span><span class="o">-</span><span class="mi">11</span> <span class="n">jro0014</span>         <span class="mi">00</span><span class="p">:</span><span class="mi">00</span><span class="p">:</span><span class="mi">13</span> <span class="n">R</span> <span class="n">general</span>
<span class="o">...</span>
</pre></div>
</div>
<p>The <code class="docutils literal notranslate"><span class="pre">submit_sim_analyses.sh</span></code> restricts the job array to only allow
at most 400 of the jobs to run at a time.
The job array will cycle through all 960 jobs until they all finish.</p>
<p>If you just want to know how many jobs are actively running, you can
pipe the output of <code class="docutils literal notranslate"><span class="pre">qstat</span> <span class="pre">-t</span></code> to <code class="docutils literal notranslate"><span class="pre">grep</span></code> and then to <code class="docutils literal notranslate"><span class="pre">wc</span></code>:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">qstat</span> <span class="o">-</span><span class="n">t</span> <span class="o">|</span> <span class="n">grep</span> <span class="o">-</span><span class="n">i</span> <span class="s2">&quot;R gen&quot;</span> <span class="o">|</span> <span class="n">wc</span> <span class="o">-</span><span class="n">l</span>
</pre></div>
</div>
<p>You can change this to get the number of jobs the array
currently has waiting to run:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">qstat</span> <span class="o">-</span><span class="n">t</span> <span class="o">|</span> <span class="n">grep</span> <span class="o">-</span><span class="n">i</span> <span class="s2">&quot;Q gen&quot;</span> <span class="o">|</span> <span class="n">wc</span> <span class="o">-</span><span class="n">l</span>
</pre></div>
</div>
<p>The job array will create a lot of output files in your <code class="docutils literal notranslate"><span class="pre">scripts</span></code> directory.
If all is working well, you can get rid of these using the following command
from within the <code class="docutils literal notranslate"><span class="pre">scripts</span></code> directory of the project:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">rm</span> <span class="n">spawn_job_array</span><span class="o">.*</span>
</pre></div>
</div>
<p>If all is <em>not</em> going well, these output files might have content to help
you figure out what the problem is.</p>
<p>Once the <code class="docutils literal notranslate"><span class="pre">qstat</span> <span class="pre">-t</span></code> command is showing that all of your analyses have
finished, we will run the <code class="docutils literal notranslate"><span class="pre">submit_sim_analyses.sh</span></code> script again.
If any of the 960 jobs failed, they will get re-run:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">bash</span> <span class="n">submit_sim_analyses</span><span class="o">.</span><span class="n">sh</span> <span class="o">../</span><span class="n">ecoevolity</span><span class="o">-</span><span class="n">simulations</span><span class="o">/*/</span><span class="n">batch</span><span class="o">-</span><span class="mi">308303035</span>
</pre></div>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Only re-run this command <em>after</em> all the analyses started
by this command the first time are no longer running.
In other words, the <code class="docutils literal notranslate"><span class="pre">qstat</span> <span class="pre">-t</span></code> should produce no output (assuming you are
not running analyses for other projects) before you re-run this command.</p>
</div>
<p>If most of your analyses finished successfully, the script will seem like
it’s running slow.
Just be patient; it is checking the output of all the analyses, and only writes
a message to the screen if it finds an analysis that didn’t finish
successfully.
So, if it seems like nothing is happening, that’s a good thing (i.e., the
script is finding lots of successfully completed analyses).
Your output from running the <code class="docutils literal notranslate"><span class="pre">submit_sim_analyses.sh</span></code> script for a second
time might look something like:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">Beginning</span> <span class="n">to</span> <span class="n">vet</span> <span class="ow">and</span> <span class="n">consolidate</span> <span class="n">sim</span> <span class="n">analysis</span> <span class="n">files</span> <span class="ow">in</span><span class="p">:</span>
  <span class="s1">&#39;../ecoevolity-simulations/fixed-pairs-10-independent-time-1_0-0_05-chars-100000/batch-579088984&#39;</span>
<span class="n">Incomplete</span> <span class="n">stdout</span><span class="p">:</span> <span class="o">/</span><span class="n">home</span><span class="o">/</span><span class="n">jro0014</span><span class="o">/</span><span class="n">ecoevolity</span><span class="o">-</span><span class="n">model</span><span class="o">-</span><span class="n">prior</span><span class="o">/</span><span class="n">ecoevolity</span><span class="o">-</span><span class="n">simulations</span><span class="o">/</span><span class="n">fixed</span><span class="o">-</span><span class="n">pairs</span><span class="o">-</span><span class="mi">10</span><span class="o">-</span><span class="n">independent</span><span class="o">-</span><span class="n">time</span><span class="o">-</span><span class="mi">1_0</span><span class="o">-</span><span class="mi">0_05</span><span class="o">-</span><span class="n">chars</span><span class="o">-</span><span class="mi">100000</span><span class="o">/</span><span class="n">batch</span><span class="o">-</span><span class="mi">579088984</span><span class="o">/</span><span class="n">pairs</span><span class="o">-</span><span class="mi">10</span><span class="o">-</span><span class="n">dpp</span><span class="o">-</span><span class="n">conc</span><span class="o">-</span><span class="mi">2_0</span><span class="o">-</span><span class="mi">2_71</span><span class="o">-</span><span class="n">time</span><span class="o">-</span><span class="mi">1_0</span><span class="o">-</span><span class="mi">0_05</span><span class="o">-</span><span class="n">sim</span><span class="o">-</span><span class="mi">07</span><span class="o">-</span><span class="n">config</span><span class="o">-</span><span class="n">run</span><span class="o">-</span><span class="mi">3</span><span class="o">-</span><span class="n">qsub</span><span class="o">.</span><span class="n">sh</span>
<span class="n">Incomplete</span> <span class="n">stdout</span><span class="p">:</span> <span class="o">/</span><span class="n">home</span><span class="o">/</span><span class="n">jro0014</span><span class="o">/</span><span class="n">ecoevolity</span><span class="o">-</span><span class="n">model</span><span class="o">-</span><span class="n">prior</span><span class="o">/</span><span class="n">ecoevolity</span><span class="o">-</span><span class="n">simulations</span><span class="o">/</span><span class="n">fixed</span><span class="o">-</span><span class="n">pairs</span><span class="o">-</span><span class="mi">10</span><span class="o">-</span><span class="n">independent</span><span class="o">-</span><span class="n">time</span><span class="o">-</span><span class="mi">1_0</span><span class="o">-</span><span class="mi">0_05</span><span class="o">-</span><span class="n">chars</span><span class="o">-</span><span class="mi">100000</span><span class="o">/</span><span class="n">batch</span><span class="o">-</span><span class="mi">579088984</span><span class="o">/</span><span class="n">pairs</span><span class="o">-</span><span class="mi">10</span><span class="o">-</span><span class="n">dpp</span><span class="o">-</span><span class="n">conc</span><span class="o">-</span><span class="mi">2_0</span><span class="o">-</span><span class="mi">2_71</span><span class="o">-</span><span class="n">time</span><span class="o">-</span><span class="mi">1_0</span><span class="o">-</span><span class="mi">0_05</span><span class="o">-</span><span class="n">sim</span><span class="o">-</span><span class="mi">07</span><span class="o">-</span><span class="n">config</span><span class="o">-</span><span class="n">run</span><span class="o">-</span><span class="mi">4</span><span class="o">-</span><span class="n">qsub</span><span class="o">.</span><span class="n">sh</span>
<span class="n">Incomplete</span> <span class="n">stdout</span><span class="p">:</span> <span class="o">/</span><span class="n">home</span><span class="o">/</span><span class="n">jro0014</span><span class="o">/</span><span class="n">ecoevolity</span><span class="o">-</span><span class="n">model</span><span class="o">-</span><span class="n">prior</span><span class="o">/</span><span class="n">ecoevolity</span><span class="o">-</span><span class="n">simulations</span><span class="o">/</span><span class="n">fixed</span><span class="o">-</span><span class="n">pairs</span><span class="o">-</span><span class="mi">10</span><span class="o">-</span><span class="n">independent</span><span class="o">-</span><span class="n">time</span><span class="o">-</span><span class="mi">1_0</span><span class="o">-</span><span class="mi">0_05</span><span class="o">-</span><span class="n">chars</span><span class="o">-</span><span class="mi">100000</span><span class="o">/</span><span class="n">batch</span><span class="o">-</span><span class="mi">579088984</span><span class="o">/</span><span class="n">pairs</span><span class="o">-</span><span class="mi">10</span><span class="o">-</span><span class="n">dpp</span><span class="o">-</span><span class="n">conc</span><span class="o">-</span><span class="mi">2_0</span><span class="o">-</span><span class="mi">2_71</span><span class="o">-</span><span class="n">time</span><span class="o">-</span><span class="mi">1_0</span><span class="o">-</span><span class="mi">0_05</span><span class="o">-</span><span class="n">sim</span><span class="o">-</span><span class="mi">08</span><span class="o">-</span><span class="n">config</span><span class="o">-</span><span class="n">run</span><span class="o">-</span><span class="mi">1</span><span class="o">-</span><span class="n">qsub</span><span class="o">.</span><span class="n">sh</span>
<span class="n">Beginning</span> <span class="n">to</span> <span class="n">vet</span> <span class="ow">and</span> <span class="n">consolidate</span> <span class="n">sim</span> <span class="n">analysis</span> <span class="n">files</span> <span class="ow">in</span><span class="p">:</span>
  <span class="s1">&#39;../ecoevolity-simulations/fixed-pairs-10-independent-time-1_0-0_05-chars-10000/batch-579088984&#39;</span>
<span class="n">Beginning</span> <span class="n">to</span> <span class="n">vet</span> <span class="ow">and</span> <span class="n">consolidate</span> <span class="n">sim</span> <span class="n">analysis</span> <span class="n">files</span> <span class="ow">in</span><span class="p">:</span>
  <span class="s1">&#39;../ecoevolity-simulations/fixed-pairs-10-independent-time-1_0-0_05-chars-50000/batch-579088984&#39;</span>
<span class="n">Beginning</span> <span class="n">to</span> <span class="n">vet</span> <span class="ow">and</span> <span class="n">consolidate</span> <span class="n">sim</span> <span class="n">analysis</span> <span class="n">files</span> <span class="ow">in</span><span class="p">:</span>
  <span class="s1">&#39;../ecoevolity-simulations/fixed-pairs-10-independent-time-1_0-0_05-chars-5000/batch-579088984&#39;</span>
<span class="n">Submitting</span> <span class="n">analyses</span> <span class="n">to</span> <span class="n">queue</span><span class="o">...</span>
<span class="o">../</span><span class="nb">bin</span><span class="o">/</span><span class="n">psub</span> <span class="o">-</span><span class="n">t</span> <span class="mi">00</span><span class="p">:</span><span class="mi">30</span><span class="p">:</span><span class="mi">00</span> <span class="o">-</span><span class="n">a</span> <span class="mi">1</span><span class="o">-</span><span class="mi">3</span> <span class="o">../</span><span class="nb">bin</span><span class="o">/</span><span class="n">spawn_job_array</span> <span class="o">/</span><span class="n">home</span><span class="o">/</span><span class="n">jro0014</span><span class="o">/</span><span class="n">ecoevolity</span><span class="o">-</span><span class="n">model</span><span class="o">-</span><span class="n">prior</span><span class="o">/</span><span class="n">scripts</span><span class="o">/</span><span class="n">spawn_job_array</span><span class="o">.</span><span class="n">ahk9ldpOomQI</span>
<span class="n">qsub</span> <span class="o">-</span><span class="n">q</span> <span class="n">general</span> <span class="o">-</span><span class="n">j</span> <span class="n">oe</span> <span class="o">-</span><span class="n">l</span> <span class="n">nodes</span><span class="o">=</span><span class="mi">1</span><span class="p">:</span><span class="n">ppn</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="n">walltime</span><span class="o">=</span><span class="mi">00</span><span class="p">:</span><span class="mi">30</span><span class="p">:</span><span class="mi">00</span> <span class="o">-</span><span class="n">t</span> <span class="mi">1</span><span class="o">-</span><span class="mi">3</span> <span class="o">../</span><span class="nb">bin</span><span class="o">/</span><span class="n">spawn_job_array</span> <span class="o">-</span><span class="n">F</span>  <span class="s2">&quot;/home/jro0014/ecoevolity-model-prior/scripts/spawn_job_array.ahk9ldpOomQI&quot;</span>
<span class="mi">1977829</span><span class="p">[]</span><span class="o">.</span><span class="n">hopper</span><span class="o">-</span><span class="n">mgt</span>
</pre></div>
</div>
<p>This output tell us that a small number (3) of the analyses failed to finish
correctly, and are being re-run via a new job array.
Again, you can monitor the progress of your re-analyses using <code class="docutils literal notranslate"><span class="pre">qstat</span> <span class="pre">-t</span></code>, and
once they finish, go ahead and run the <code class="docutils literal notranslate"><span class="pre">submit_sim_analyses.sh</span></code> script for a
third time (from within the <code class="docutils literal notranslate"><span class="pre">scripts</span></code> directory):</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">bash</span> <span class="n">submit_sim_analyses</span><span class="o">.</span><span class="n">sh</span> <span class="o">../</span><span class="n">ecoevolity</span><span class="o">-</span><span class="n">simulations</span><span class="o">/*/</span><span class="n">batch</span><span class="o">-</span><span class="mi">308303035</span>
</pre></div>
</div>
<p>Hopefully the third time, your output will look like:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>Beginning to vet and consolidate sim analysis files in:
  &#39;../ecoevolity-simulations/fixed-pairs-10-independent-time-1_0-0_05-chars-100000/batch-579088984&#39;
Beginning to vet and consolidate sim analysis files in:
  &#39;../ecoevolity-simulations/fixed-pairs-10-independent-time-1_0-0_05-chars-10000/batch-579088984&#39;
Beginning to vet and consolidate sim analysis files in:
  &#39;../ecoevolity-simulations/fixed-pairs-10-independent-time-1_0-0_05-chars-50000/batch-579088984&#39;
Beginning to vet and consolidate sim analysis files in:
  &#39;../ecoevolity-simulations/fixed-pairs-10-independent-time-1_0-0_05-chars-5000/batch-579088984&#39;
All analyses are complete and clean!
</pre></div>
</div>
<p>This confirms that all of your analyses have successfully finished!
Note, the job failure rate of the Hopper cluster
fluctuates.
So, you might have some failures that get re-run during your third use
of <code class="docutils literal notranslate"><span class="pre">submit_sim_analyses.sh</span></code> above.
If so, just monitor those re-runs with <code class="docutils literal notranslate"><span class="pre">qstat</span> <span class="pre">-t</span></code>, and run the
<code class="docutils literal notranslate"><span class="pre">submit_sim_analyses.sh</span></code> script again after they finish (as we did three
times above).
Eventually, you should get the <code class="docutils literal notranslate"><span class="pre">All</span> <span class="pre">analyses</span> <span class="pre">are</span> <span class="pre">complete</span> <span class="pre">and</span> <span class="pre">clean!</span></code>
message.</p>
<p>Go ahead and clean out all the output files from the job array from inside the
<code class="docutils literal notranslate"><span class="pre">scripts</span></code> directory:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">rm</span> <span class="n">spawn_job_array</span><span class="o">.*</span>
</pre></div>
</div>
</div>
<div class="section" id="summarizing-the-results">
<h2>Summarizing the results<a class="headerlink" href="#summarizing-the-results" title="Permalink to this headline">¶</a></h2>
<p>After the
<code class="docutils literal notranslate"><span class="pre">submit_sim_analyses.sh</span></code> script confirms that <code class="docutils literal notranslate"><span class="pre">All</span> <span class="pre">analyses</span> <span class="pre">are</span> <span class="pre">complete</span>
<span class="pre">and</span> <span class="pre">clean!</span></code>
it is time for us to summarize the results from all 960 analyses we ran.
Our results are currently scattered across 960 log files output by
<code class="docutils literal notranslate"><span class="pre">ecoevolity</span></code> during these analyses.
These log files contain MCMC samples collected from the posterior distribution
of the respective model given each simulated dataset.
We will use the Python script <code class="docutils literal notranslate"><span class="pre">scripts/parse_sim_results.py</span></code> to parse all
these log files (posterior samples) and summarize them in tab-delimited tables.
We will run the <code class="docutils literal notranslate"><span class="pre">parse_sim_results.py</span></code> Python script using the
<code class="docutils literal notranslate"><span class="pre">parse_sim_results.sh</span></code> Bash script, so that we can submit it as a job to the
cluster’s queue.
Assuming you are on the Hopper cluster and in the <code class="docutils literal notranslate"><span class="pre">scripts</span></code> directory of your
copy of the project, run:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="o">../</span><span class="nb">bin</span><span class="o">/</span><span class="n">psub</span> <span class="n">parse_sim_results</span><span class="o">.</span><span class="n">sh</span> <span class="o">../</span><span class="n">ecoevolity</span><span class="o">-</span><span class="n">simulations</span><span class="o">/*/*</span><span class="mi">308303035</span>
</pre></div>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>If you are not on the Hopper cluster, you can simply run the Python
script directly:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">python</span> <span class="n">parse_sim_results</span><span class="o">.</span><span class="n">py</span> <span class="o">../</span><span class="n">ecoevolity</span><span class="o">-</span><span class="n">simulations</span><span class="o">/*/*</span><span class="mi">308303035</span>
</pre></div>
</div>
<p>Just make sure you have the <code class="docutils literal notranslate"><span class="pre">ecoevolity-model-prior-project</span></code> conda
environment activated.</p>
</div>
<p>Use the <code class="docutils literal notranslate"><span class="pre">qstat</span></code> command to monitor the progress of the job.
Once the output of <code class="docutils literal notranslate"><span class="pre">qstat</span></code> confirms the script has finished running,
we can count the number of lines in each of the tab-delmited text
files that were created:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">wc</span> <span class="o">-</span><span class="n">l</span> <span class="o">../</span><span class="n">ecoevolity</span><span class="o">-</span><span class="n">simulations</span><span class="o">/*/</span><span class="n">batch</span><span class="o">-</span><span class="mi">308303035</span><span class="o">/*</span><span class="n">results</span><span class="o">.</span><span class="n">tsv</span>
</pre></div>
</div>
<p>Each of these files should have 11 lines (10 lines of results, plus a line
with the column headers).</p>
<p>Now, let’s <code class="docutils literal notranslate"><span class="pre">gzip</span></code> these files:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">gzip</span> <span class="o">../</span><span class="n">ecoevolity</span><span class="o">-</span><span class="n">simulations</span><span class="o">/*/</span><span class="n">batch</span><span class="o">-</span><span class="mi">308303035</span><span class="o">/*</span><span class="n">results</span><span class="o">.</span><span class="n">tsv</span>
</pre></div>
</div>
<p>Now, add them to the staging area of the project Git repository:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">git</span> <span class="n">add</span> <span class="o">../</span><span class="n">ecoevolity</span><span class="o">-</span><span class="n">simulations</span><span class="o">/*/</span><span class="n">batch</span><span class="o">-</span><span class="mi">308303035</span><span class="o">/*</span><span class="n">results</span><span class="o">.</span><span class="n">tsv</span><span class="o">.</span><span class="n">gz</span>
</pre></div>
</div>
<p>And, commit them to the repository database:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">git</span> <span class="n">commit</span>
</pre></div>
</div>
<p>A good commit message might look something like:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">Adding</span> <span class="n">batch</span> <span class="mi">308303035</span> <span class="n">of</span> <span class="n">simulation</span> <span class="n">results</span><span class="o">.</span>

<span class="n">Adding</span> <span class="n">gzipped</span><span class="p">,</span> <span class="n">tab</span><span class="o">-</span><span class="n">delimited</span> <span class="n">files</span><span class="o">.</span> <span class="n">Each</span> <span class="n">file</span> <span class="n">summarizes</span> <span class="n">the</span> <span class="n">results</span> <span class="n">of</span>
<span class="n">ecoevolity</span> <span class="n">analyses</span> <span class="n">of</span> <span class="mi">10</span> <span class="n">simcoevolity</span> <span class="n">simulation</span> <span class="n">replicates</span><span class="o">.</span> <span class="n">Adding</span> <span class="n">these</span>
<span class="n">files</span> <span class="k">for</span> <span class="n">simulations</span> <span class="n">of</span> <span class="mi">4</span> <span class="n">different</span> <span class="n">dataset</span> <span class="n">sizes</span><span class="p">,</span> <span class="n">each</span> <span class="n">analysed</span> <span class="k">with</span> <span class="mi">3</span>
<span class="n">models</span><span class="p">,</span> <span class="k">with</span> <span class="ow">and</span> <span class="n">without</span> <span class="n">constant</span> <span class="n">characters</span><span class="o">.</span>
</pre></div>
</div>
<p>Finally, push your new results to the remote repository hosted on a <a class="reference external" href="https://github.com/">GitHub</a>
server:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">git</span> <span class="n">push</span> <span class="n">origin</span> <span class="n">master</span>
</pre></div>
</div>
</div>
<div class="section" id="cleaning-up">
<h2>Cleaning up<a class="headerlink" href="#cleaning-up" title="Permalink to this headline">¶</a></h2>
<p>After we have committed and pushed the results of our analyses, let’s cleanup
all those thousands of files that were generated during the simulations and
analyses:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">bash</span> <span class="n">archive_sim_files</span><span class="o">.</span><span class="n">sh</span> <span class="o">../</span><span class="n">ecoevolity</span><span class="o">-</span><span class="n">simulations</span><span class="o">/*/*</span><span class="mi">308303035</span>
</pre></div>
</div>
<p>This script will copy these files into compressed archives and remove the
original files.</p>
<p>Now, we can add these archives to the git repository:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">git</span> <span class="n">add</span> <span class="o">../</span><span class="n">ecoevolity</span><span class="o">-</span><span class="n">simulations</span><span class="o">/*/</span><span class="n">batch</span><span class="o">-</span><span class="mi">308303035</span><span class="o">/*.</span><span class="n">tar</span><span class="o">.</span><span class="n">gz</span>
</pre></div>
</div>
<p>And, commit them to the repository database:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">git</span> <span class="n">commit</span>
</pre></div>
</div>
<p>A good commit message might look something like:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>Adding archives of sim files for batch 308303035.

Adding compressed archives of all the ``simcoevolity`` and
``ecoevolity`` files for batch 308303035 of simulation replicates.
These files are handled by Git LFS, so only a reference to the
files is stored in the git database.
</pre></div>
</div>
<p>Finally, push everything to the remote repository on <a class="reference external" href="https://github.com/">GitHub</a>:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">git</span> <span class="n">push</span> <span class="n">origin</span> <span class="n">master</span>
</pre></div>
</div>
</div>
</div>


          </div>
          
        </div>
      </div>
    <div class="clearer"></div>
  </div>
<div class="footer" role="contentinfo" align="center">
    <a href="https://github.com/phyletica/ecoevolity-model-prior">GitHub</a> &nbsp; | &nbsp; <a href="license.html">License</a> &nbsp; | &nbsp; <a href="citation.html">Citation</a> &nbsp; | &nbsp; <a href="https://groups.google.com/forum/#!forum/ecoevolity-users">User's Forum</a>
</div>

  </body>
</html>